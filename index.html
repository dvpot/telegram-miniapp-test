<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Telegram Mini App — English Words</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>
    :root {
      --bg: #f2f5f7;
      --card: #fff;
      --accent: #0088cc;
      --muted: #6b7280;
      --radius: 14px;
    }
    html, body {
      height: 100%;
      margin: 0;
      font-family: sans-serif;
      background: var(--bg);
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }
    .app {
      max-width: 600px;
      margin: 0 auto;
      height: 100vh;
      display: flex;
      flex-direction: column;
      padding: 12px;
      box-sizing: border-box;
    }
    .card {
      background: var(--card);
      border-radius: var(--radius);
      box-shadow: 0 6px 18px rgba(11,22,34,0.08);
      padding: 16px;
      display: flex;
      flex-direction: column;
      gap: 12px;
      flex: 1 1 auto;
      overflow: hidden;
    }
    .header {
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    .username {
      font-size: 20px;
      font-weight: 700;
      margin: 0;
    }
    .sub {
      color: var(--muted);
      font-size: 13px;
    }
    .image-area {
      flex: 1 1 40%;
      min-height: 140px;
      border-radius: 10px;
      overflow: hidden;
      background: #efefef;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .image-area img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }
    .image-placeholder {
      color: var(--muted);
      font-size: 14px;
      padding: 12px;
    }
    .content {
      display: flex;
      flex-direction: column;
      gap: 16px;
    }
.field {
  background: #fafafa;
  border: 1px solid #ccc;         /* добавляем контур */
  border-radius: 10px;
  padding: 16px;
  min-height: 60px;
  display: flex;                  /* делаем flex-контейнер */
  flex-direction: column;         /* чтобы слово было сверху, транскрипция — снизу */
  justify-content: center;        /* вертикальное центрирование */
  align-items: center;            /* горизонтальное центрирование */
  cursor: pointer;
  user-select: none;
  position: relative;
  text-align: center;
}
.field.hidden {
  opacity: 0;
  transform: translateY(-10px);
  transition: opacity 300ms ease, transform 300ms ease;
}
.field.show {  /* если захочешь использовать класс show для анимации появления */
  opacity: 1;
  transform: translateY(0);
}
    .word-text {
      font-size: 22px;
      font-weight: 700;
      margin: 0;
      line-height: 1;
        opacity: 0;
  transition: opacity 300ms ease;
    }
    .trans-text {
      font-size: 16px;
      color: var(--muted);
      margin: 4px 0 0 0;
      line-height: 1.2;
        opacity: 0;
  transition: opacity 300ms ease;
    }
    .word-text.visible, .trans-text.visible {
  opacity: 1;
  transition: opacity 300ms ease;
}
    .translation-field {
      background: #fafafa;
      border-radius: 10px;
      padding: 16px;
      min-height: 60px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .translation-text {
      font-size: 24px;
      font-weight: 700;
      text-align: center;
      margin: 0;
    }
    .footer {
      display: flex;
      align-items: center;
      justify-content: center;
      padding-top: 6px;
    }
    .btn {
      width: 100%;
      padding: 12px 16px;
      border-radius: 10px;
      background: var(--accent);
      color: #fff;
      border: none;
      font-size: 16px;
      font-weight: 700;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <div class="app">
    <div class="card">
      <div class="header">
        <div>
          <div id="username" class="username">Привет!</div>
        </div>
      </div>

      <div id="imageArea" class="image-area">
        <div id="imagePlaceholder" class="image-placeholder">Картинка отсутствует</div>
      </div>

      <div class="content">
        <div id="wordField" class="field">
          <div>
            <p id="wordText" class="word-text">---</p>
            <p id="transText" class="trans-text">[---]</p>
          </div>
        </div>

        <div class="translation-field">
          <p id="translationText" class="translation-text">---</p>
        </div>
      </div>

      <div class="footer">
        <button id="nextBtn" class="btn">Следующее слово</button>
      </div>
    </div>
  </div>

  <script>
    const tg = window.Telegram?.WebApp;
    if (tg) tg.ready();

    const usernameEl = document.getElementById('username');
    const user = tg?.initDataUnsafe?.user;
    if (user) {
      usernameEl.textContent = `Привет, ${user.first_name || user.username}!`;
    }

    const imageArea = document.getElementById('imageArea');
    const imagePlaceholder = document.getElementById('imagePlaceholder');
    const wordField = document.getElementById('wordField');
    const wordText = document.getElementById('wordText');
    const transText = document.getElementById('transText');
    const translationText = document.getElementById('translationText');
    const nextBtn = document.getElementById('nextBtn');

    let words = [];
    let current = null;
    let wordRevealed = false;

    async function loadWords() {
      const resp = await fetch('words.json', { cache: "no-store" });
      words = await resp.json();
    }

    function setImage(src) {
      imageArea.innerHTML = '';
      if (src) {
        const img = document.createElement('img');
        img.src = src;
        img.alt = 'image';
        img.onerror = () => {
          imageArea.innerHTML = '<div class="image-placeholder">Картинка недоступна</div>';
        };
        imageArea.appendChild(img);
      } else {
        imageArea.innerHTML = '<div class="image-placeholder">Картинка отсутствует</div>';
      }
    }

    function loadRandomWord() {
      if (!words.length) return;
      const idx = Math.floor(Math.random() * words.length);
      current = words[idx];
      wordRevealed = false;

  wordText.textContent = current.word || '---';
  transText.textContent = current.transcription || '---';
  translationText.textContent = current.translation || '---';
  setImage(current.image && current.image.length ? current.image : null);

  // Скрываем поле полностью (чтобы анимация срабатывала)
  wordField.classList.add('hidden');

  // Убираем метку "visible" у текста
  wordText.classList.remove('visible');
  transText.classList.remove('visible');

 // Даем полю класс hidden, чтобы скрыть текст сразу
  wordField.classList.add('hidden');

  // Через небольшой таймаут показываем сам контейнер поля, но текст — всё ещё скрыт
  setTimeout(() => {
    wordField.classList.remove('hidden');
  }, 50);
}

wordField.addEventListener('click', () => {
  if (!wordRevealed) {
    wordText.classList.add('visible');
    transText.classList.add('visible');
    wordRevealed = true;
  }
});

    nextBtn.addEventListener('click', () => {
      loadRandomWord();
    });

    (async () => {
      await loadWords();
      loadRandomWord();
    })();
  </script>
</body>
</html>




